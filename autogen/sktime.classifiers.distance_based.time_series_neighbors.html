

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sktime.classifiers.distance_based.time_series_neighbors module &mdash; sktime  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sktime.classifiers.frequency_based package" href="sktime.classifiers.frequency_based.html" />
    <link rel="prev" title="sktime.classifiers.distance_based.proximity_forest module" href="sktime.classifiers.distance_based.proximity_forest.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sktime
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="sktime.html">sktime package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="sktime.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="sktime.classifiers.html">sktime.classifiers package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="sktime.classifiers.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="sktime.classifiers.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sktime.contrib.html">sktime.contrib package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.datasets.html">sktime.datasets package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.distances.html">sktime.distances package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.experiments.html">sktime.experiments package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.forecasters.html">sktime.forecasters package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.highlevel.html">sktime.highlevel package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.metrics.html">sktime.metrics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.regressors.html">sktime.regressors package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sktime.transformers.html">sktime.transformers package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sktime.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extension.html">Extension Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sktime</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="sktime.html">sktime package</a> &raquo;</li>
        
          <li><a href="sktime.classifiers.html">sktime.classifiers package</a> &raquo;</li>
        
          <li><a href="sktime.classifiers.distance_based.html">sktime.classifiers.distance_based package</a> &raquo;</li>
        
      <li>sktime.classifiers.distance_based.time_series_neighbors module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/autogen/sktime.classifiers.distance_based.time_series_neighbors.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-sktime.classifiers.distance_based.time_series_neighbors">
<span id="sktime-classifiers-distance-based-time-series-neighbors-module"></span><h1>sktime.classifiers.distance_based.time_series_neighbors module<a class="headerlink" href="#module-sktime.classifiers.distance_based.time_series_neighbors" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier">
<em class="property">class </em><code class="sig-prename descclassname">sktime.classifiers.distance_based.time_series_neighbors.</code><code class="sig-name descname">KNeighborsTimeSeriesClassifier</code><span class="sig-paren">(</span><em class="sig-param">n_neighbors=1</em>, <em class="sig-param">weights='uniform'</em>, <em class="sig-param">algorithm='brute'</em>, <em class="sig-param">metric='dtw'</em>, <em class="sig-param">metric_params=None</em>, <em class="sig-param">dim_to_use=0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sktime/classifiers/distance_based/time_series_neighbors.html#KNeighborsTimeSeriesClassifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.neighbors.classification.KNeighborsClassifier</span></code></p>
<p>An adapted version of the scikit-learn KNeighborsClassifier to work with time series data.</p>
<dl>
<dt>Necessary changes required for time series data:</dt><dd><ul>
<li><p>calls to X.shape in kneighbors, predict and predict_proba.
In the base class, these methods contain:</p>
<blockquote>
<div><p>n_samples, _ = X.shape</p>
</div></blockquote>
<p>This however assumes that data must be 2d (a set of multivariate time series is 3d). Therefore these methods
needed to be overridden to change this call to the following to support 3d data:</p>
<blockquote>
<div><p>n_samples = X.shape[0]</p>
</div></blockquote>
</li>
<li><p>check array has been disabled. This method allows nd data via an argument in the method header. However, there
seems to be no way to set this in the classifier and allow it to propagate down to the method. Therefore, this
method has been temporarily disabled (and then re-enabled). It is unclear how to fix this issue without either
writing a new classifier from scratch or changing the scikit-learn implementation. TO-DO: find permanent
resolution to this issue (raise as an issue on sklearn GitHub?)</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sktime/classifiers/distance_based/time_series_neighbors.html#KNeighborsTimeSeriesClassifier.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the model using X as training data and y as target values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>sktime-format pandas dataframe with shape</em><em>(</em><em>[</em><em>n_cases</em><em>,</em><em>n_dimensions</em><em>]</em><em>)</em><em>,</em>) – </p></li>
<li><p><strong>numpy ndarray with shape</strong><strong>(</strong><strong>[</strong><strong>n_cases</strong><strong>,</strong><strong>n_readings</strong><strong>,</strong><strong>n_dimensions</strong><strong>]</strong><strong>)</strong> (<em>or</em>) – </p></li>
<li><p><strong>y</strong> (<em>{array-like</em><em>, </em><em>sparse matrix}</em>) – Target values of shape = [n_samples]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.kneighbors">
<code class="sig-name descname">kneighbors</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">n_neighbors=None</em>, <em class="sig-param">return_distance=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sktime/classifiers/distance_based/time_series_neighbors.html#KNeighborsTimeSeriesClassifier.kneighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.kneighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the K-neighbors of a point.
Returns indices of and distances to the neighbors of each point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>sktime-format pandas dataframe with shape</em><em>(</em><em>[</em><em>n_cases</em><em>,</em><em>n_dimensions</em><em>]</em><em>)</em><em>,</em>) – </p></li>
<li><p><strong>numpy ndarray with shape</strong><strong>(</strong><strong>[</strong><strong>n_cases</strong><strong>,</strong><strong>n_readings</strong><strong>,</strong><strong>n_dimensions</strong><strong>]</strong><strong>)</strong> (<em>or</em>) – </p></li>
<li><p><strong>y</strong> (<em>{array-like</em><em>, </em><em>sparse matrix}</em>) – Target values of shape = [n_samples]</p></li>
<li><p><strong>n_neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of neighbors to get (default is the value
passed to the constructor).</p></li>
<li><p><strong>return_distance</strong> (<em>boolean</em><em>, </em><em>optional. Defaults to True.</em>) – If False, distances will not be returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dist</strong> (<em>array</em>) – Array representing the lengths to points, only present if
return_distance=True</p></li>
<li><p><strong>ind</strong> (<em>array</em>) – Indices of the nearest points in the population matrix.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>In the following example, we construct a NeighborsClassifier
class from an array representing our data set and ask who’s
the closest point to [1,1,1]</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">NearestNeighbors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">NearestNeighbors(algorithm=&#39;auto&#39;, leaf_size=30, ...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]))</span> <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">(array([[0.5]]), array([[2]]))</span>
</pre></div>
</div>
<p>As you can see, it returns [[0.5]], and [[2]], which means that the
element is at distance 0.5 and is the third element of samples
(indexes start at 0). You can also query for multiple points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_distance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">array([[1],</span>
<span class="go">       [2]]...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">X</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sktime/classifiers/distance_based/time_series_neighbors.html#KNeighborsTimeSeriesClassifier.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the class labels for the provided data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>sktime-format pandas dataframe</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_query</em><em>, </em><em>n_features</em><em>)</em><em>,                 or </em><em>(</em><em>n_query</em><em>, </em><em>n_indexed</em><em>) </em><em>if metric == 'precomputed'</em>) – Test samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> – Class labels for each data sample.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of shape [n_samples] or [n_samples, n_outputs]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.predict_proba">
<code class="sig-name descname">predict_proba</code><span class="sig-paren">(</span><em class="sig-param">X</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sktime/classifiers/distance_based/time_series_neighbors.html#KNeighborsTimeSeriesClassifier.predict_proba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sktime.classifiers.distance_based.time_series_neighbors.KNeighborsTimeSeriesClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Return probability estimates for the test data X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>sktime-format pandas dataframe</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_query</em><em>, </em><em>n_features</em><em>)</em><em>,                 or </em><em>(</em><em>n_query</em><em>, </em><em>n_indexed</em><em>) </em><em>if metric == 'precomputed'</em>) – Test samples.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – of such arrays if n_outputs &gt; 1.
The class probabilities of the input samples. Classes are ordered
by lexicographic order.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of shape = [n_samples, n_classes], or a list of n_outputs</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sktime.classifiers.distance_based.time_series_neighbors.check_data_sktime_tsc">
<code class="sig-prename descclassname">sktime.classifiers.distance_based.time_series_neighbors.</code><code class="sig-name descname">check_data_sktime_tsc</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">dim_to_use=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sktime/classifiers/distance_based/time_series_neighbors.html#check_data_sktime_tsc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sktime.classifiers.distance_based.time_series_neighbors.check_data_sktime_tsc" title="Permalink to this definition">¶</a></dt>
<dd><p>A utility method to check the input of a TSC KNN classifier. The data must either be in</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>the standard sktime format (pandas dataframe with n rows and d columns for n cases with d dimesions)</p></li>
</ol>
<p>OR</p>
<ol class="loweralpha simple" start="2">
<li><p>a numpy ndarray with shape([n_cases,n_readings,n_dimensions]) to match the expected format for cython
distance mesures.</p></li>
</ol>
</div></blockquote>
<p>If the data matches a it will be transformed into b) and returned. If it is already in b), the input X will be
returned without modification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>sktime-format pandas dataframe with shape</em><em>(</em><em>[</em><em>n_cases</em><em>,</em><em>n_dimensions</em><em>]</em><em>)</em><em>,</em>) – </p></li>
<li><p><strong>numpy ndarray with shape</strong><strong>(</strong><strong>[</strong><strong>n_cases</strong><strong>,</strong><strong>n_readings</strong><strong>,</strong><strong>n_dimensions</strong><strong>]</strong><strong>)</strong> (<em>or</em>) – </p></li>
<li><p><strong>y</strong> (<em>{array-like</em><em>, </em><em>sparse matrix}</em>) – Target values of shape = [n_samples]</p></li>
<li><p><strong>dim_to_use</strong> (<em>indesx of the dimension to use</em><em> (</em><em>defaults to 0</em><em>, </em><em>i.e. first dimension</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy ndarray with shape([n_cases,n_readings,n_dimensions])</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sktime.classifiers.frequency_based.html" class="btn btn-neutral float-right" title="sktime.classifiers.frequency_based package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sktime.classifiers.distance_based.proximity_forest.html" class="btn btn-neutral float-left" title="sktime.classifiers.distance_based.proximity_forest module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, The Alan Turing Institute

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>